// Handle cropping functionality (Cropper.js)
uploadInput.addEventListener('change', event => {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = e => {
        const image = document.createElement('img');
        image.src = e.target.result;
        image.id = 'crop-image';
        gallery.innerHTML = ''; // Clear gallery for cropping
        gallery.appendChild(image);

        const cropper = new Cropper(image, {
            aspectRatio: 1, // Adjust aspect ratio if needed
            crop(event) {
                console.log(`Crop details: X=${event.detail.x}, Y=${event.detail.y}, Width=${event.detail.width}, Height=${event.detail.height}`);
            }
        });

        // Add a save button to finalize the crop
        const saveCropButton = document.createElement('button');
        saveCropButton.textContent = "Save Crop";
        saveCropButton.addEventListener('click', () => {
            const canvas = cropper.getCroppedCanvas();
            const croppedImage = canvas.toDataURL('image/png');
            wardrobe.push({ image: croppedImage, category: "Uncategorized", tags: [] });
            displayWardrobe(wardrobe);
            cropper.destroy(); // Remove cropper instance
            gallery.innerHTML = ''; // Clear the gallery
        });
        gallery.appendChild(saveCropButton);
    };

    reader.readAsDataURL(file);
});
